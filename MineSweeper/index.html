<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<title>지뢰찾기</title>
	<style>
		body{
			padding: 50px;
		}
		table{
			border: 15px solid #EEE;
			border-collapse: collapse;
		}
		td{
			padding:0;
			margin:0;
			border-spacing: 0;
			border:1px solid #DDD;
			border-collapse: collapse;
			margin: 0;
			height:40px;
			width:40px;
			text-align: center;
			cursor:pointer;
		}
		.bomb{
			background-color: red;
			/*color:#FFF;*/
		}
	</style>
</head>
<body>
	<table >
		<tbody id="board">
			
		</tbody>
	</table>
<script>
	
	/* 게임 세팅 */
	const boardSize = {
		w : 10,
		h : 10
	};
    const bombCnt = 30;


	/* 지뢰 정보 */
	const cellCnt = boardSize.w * boardSize.h;

	let cellArr = [];
	for(let i = 0; i < cellCnt; i++){
		cellArr[i] = i;
	}

	let bombArr = [];
	for(let i = 0; i < bombCnt; i++){
		const randNum = Math.floor(Math.random() * (cellCnt - i));
		bombArr.push(cellArr[randNum]);
		cellArr.splice(randNum,1);
	}


	/* 지뢰밭 정보 */

    const boardTable = document.getElementById('board');

    let boardInfo = new Array(cellCnt);

    function getBoardInfo(){
        /**
         * 모서리 : 좌상, 우상, 좌하, 우하
         * 모서리를 제외한 : 윗줄, 이랫줄, 왼줄, 오른줄
         * 기타 9칸
         */

            // 1) 칸 구분

        const topLeft = 0; //좌상
        const topRight = boardSize.w - 1; //우상
        const bottomLeft = boardSize.w * (boardSize.h - 1);
        const bottomRight = (boardSize.w * boardSize.h) - 1;

        // cellColoring(topLeft, 'yellow');
        // cellColoring(topRight, 'yellow');
        // cellColoring(bottomLeft, 'yellow');
        // cellColoring(bottomRight, 'yellow');


        const top = [];
        const left = [];
        const right = [];
        const bottom = [];

        for(let i = 0; i< boardSize.h; i ++){

            for(let j = 0; j< boardSize.w; j ++){
                const boxIndex = i*boardSize.w + j;
                switch (true) {
					case (boxIndex < 1) :
                        boardInfo[boxIndex] = 'top';
                        break;
                    case (boxIndex === boardSize.w - 1) :
                        boardInfo[boxIndex] = 'topRight';
                        break;
					default:
						// boardInfo[boxIndex] = 'normal';
                }
                // if(boxIndex === 0){
                //     boardInfo[i] = 'top';
				// }
            }

        }
        console.log(boardInfo);
    }
    getBoardInfo();
		
	/* 지뢰밭 생성 */
	let board = ''
	for(let i = 0; i< boardSize.h; i ++){
		board +='<tr>';
		for(let j = 0; j< boardSize.w; j ++){
			const boxIndex = i*boardSize.w + j;
			let styleClass = '';
			let textContent = boxIndex;
//			var textContent = '🚩';
			if(bombArr.indexOf(boxIndex) > -1){
				styleClass='bomb';
				textContent = '💣'
			}
			if(boxIndex === bombArr[0]){
				styleClass='';
				textContent = '🚩';
			}
			// document.createElement('td');
			board +="<td data-index='" + boxIndex + "' class='" + styleClass + "'>" + textContent + "</td>";
		}
		board +='</tr>';
	};
	

	boardTable.innerHTML = board;
	
	
	/* 클릭 이벤트 */
	boardTable.addEventListener('click', function(e){
		handleClickCell(e.target.dataset.index);
	})
	
	function handleClickCell(index){
		if(bombArr.indexOf(Number(index)) > -1){
			alert('지뢰를 밟았어요');
		}else{
			console.log(index);
		}
	}
	
	function rightClick(){
		
	}

	function cellColoring(index, bgColor) {
		const cell = boardTable.querySelector("[data-index='"+index+"']");
		cell.style.backgroundColor = bgColor
    }

	
	
</script>
</body>
</html>